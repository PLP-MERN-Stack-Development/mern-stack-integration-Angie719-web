<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MERN Blog - API UI</title>
  <style>
    body { font-family: system-ui, Arial; margin: 24px; }
    pre { background:#f6f8fa; padding:12px; border-radius:6px; }
  </style>
</head>
<body>
  <h1>MERN Blog API</h1>
  <p id="status">Checking API...</p>
  <button id="refresh">Refresh posts</button>
  <ul id="posts"></ul>

  <script>
    const statusEl = document.getElementById('status');
    const postsEl = document.getElementById('posts');
    const refresh = document.getElementById('refresh');

    async function fetchPosts() {
      statusEl.textContent = 'Loading posts...';
      postsEl.innerHTML = '';
      try {
        const res = await fetch('/api/posts');
        if (!res.ok) throw new Error(res.status + ' ' + res.statusText);
        const data = await res.json();
        statusEl.textContent = 'Loaded ' + (Array.isArray(data) ? data.length : 1) + ' item(s)';
        const items = Array.isArray(data) ? data : (data.posts || []);
        if (!items.length) postsEl.innerHTML = '<li>No posts found.</li>';
        items.forEach(p => {
          const li = document.createElement('li');
          li.innerHTML = '<strong>' + (p.title || p._id || 'Untitled') + '</strong> â€” ' +
                         (p.description ? '<span>' + p.description + '</span>' : '<em>No description</em>');
          postsEl.appendChild(li);
        });
      } catch (err) {
        statusEl.textContent = 'Error: ' + err.message;
        postsEl.innerHTML = '<li>Unable to fetch posts</li>';
      }
    }

    refresh.addEventListener('click', fetchPosts);
    // initial load
    fetchPosts();
  </script>
</body>
</html>